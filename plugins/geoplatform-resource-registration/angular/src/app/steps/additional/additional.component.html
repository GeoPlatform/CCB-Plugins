<mat-card>

    <mat-card-subtitle>
        Optionally, specify one or more keywords, publishing agencies, and
        associated GeoPlatform communities.
    </mat-card-subtitle>


    <form [formGroup]="formGroup">

        <div class="additional__container">

            <div class="additional__section">

                <mat-form-field floatLabel="always">
                    <mat-label>Keywords</mat-label>
                    <mat-chip-list #keyChipList>
                        <mat-chip
                            *ngFor="let key of keywords"
                            [selectable]="true"
                            [removable]="true"
                            (removed)="removeKeyword(key)">
                            {{key}}
                            <mat-icon matChipRemove>cancel</mat-icon>
                        </mat-chip>
                        <input matInput #keywordsInput
                            formControlName="$keywords"
                            [matChipInputFor]="keyChipList"
                            (matChipInputTokenEnd)="addKeyword($event)">
                    </mat-chip-list>
                    <mat-hint>Press 'ENTER' to add each keyword</mat-hint>
                </mat-form-field>


                <gprr-autocomplete-mat-chip
                    [label]="'Communities'"
                    [placeholder]="'Associate communities'"
                    [hint]="'Find communities using the typeahead and select them to associate'"
                    [fieldName]="'usedBy'"
                    [formGroup]="formGroup"
                    [filterFn]="filterCommunities">
                </gprr-autocomplete-mat-chip>

            </div>

        </div>

        <div class="m-message m-message--error" *ngIf="hasError">
            <div class="m-message__heading">
                <mat-icon class="m-message__icon">error</mat-icon>
                {{hasError.label||"An Error Occurred"}}
            </div>
            <div class="m-message__body">
                {{hasError.message||"Something unexpected happened and an unknonwn error has occurred."}}
            </div>
        </div>

    </form>


    <mat-card-actions>
        <div class="m-step__buttons">
            <button mat-raised-button matStepperPrevious class="nav-btn">Back</button>
            <button mat-raised-button color="primary" matStepperNext
                [disabled]="formGroup.invalid || !data.createdBy">Continue</button>
        </div>
    </mat-card-actions>

</mat-card>
