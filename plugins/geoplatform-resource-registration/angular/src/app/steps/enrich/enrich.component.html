<mat-card>

    <mat-card-subtitle>
        Optionally, specify one or more concepts for the knowledge graph of the resource
        using the fields below.
    </mat-card-subtitle>


    <form [formGroup]="formGroupPrivate">

        <div class="enrich__container">

            <div class="enrich__section">

                <!-- PURPOSES -->
                <mat-form-field floatLabel="always">
                    <mat-label>Purpose</mat-label>
                    <mat-chip-list #purposeChipList>
                        <mat-chip
                            *ngFor="let purpose of purposes"
                            [selectable]="true"
                            [removable]="true"
                            (removed)="removePurpose(purpose)">
                            {{purpose.label}}
                            <mat-icon matChipRemove>cancel</mat-icon>
                        </mat-chip>
                        <input matInput #purposeInput
                            formControlName="purposes"
                            [matAutocomplete]="purposeAutoComplete"
                            [matChipInputFor]="purposeChipList"
                            (matChipInputTokenEnd)="addPurpose($event)"
                            placeholder="Specify purpose(s) for this resource">
                        <mat-icon matSuffix
                            *ngIf="purposesField.nativeElement.value.length"
                            (click)="purposesField.nativeElement.value=''">
                            close
                        </mat-icon>
                    </mat-chip-list>
                    <mat-autocomplete #purposeAutoComplete="matAutocomplete"
                        (optionSelected)="onPurposeAutocompleteSelection($event)">
                        <mat-option *ngFor="let option of filteredPurposeOptions | async" [value]="option">
                            {{ option.label }} <span class="u-text--xs t-fg--gray-md">{{ option.uri }}</span>
                        </mat-option>
                    </mat-autocomplete>
                    <mat-hint>Find purposes using the typeahead and select them to associate</mat-hint>
                </mat-form-field>
            </div>

            <div class="enrich__section">
                <!-- FUNCTIONS -->
                <mat-form-field floatLabel="always">
                    <mat-label>Function</mat-label>
                    <mat-chip-list #functionChipList>
                        <mat-chip
                            *ngFor="let function of functions"
                            [selectable]="true"
                            [removable]="true"
                            (removed)="removeFunction(function)">
                            {{function.label}}
                            <mat-icon matChipRemove>cancel</mat-icon>
                        </mat-chip>
                        <input matInput #functionInput
                            formControlName="functions"
                            [matAutocomplete]="functionAutoComplete"
                            [matChipInputFor]="functionChipList"
                            (matChipInputTokenEnd)="addFunction($event)"
                            placeholder="Specify function(s) for this resource">
                        <mat-icon matSuffix
                            *ngIf="functionsField.nativeElement.value.length"
                            (click)="functionsField.nativeElement.value=''">
                            close
                        </mat-icon>
                    </mat-chip-list>
                    <mat-autocomplete #functionAutoComplete="matAutocomplete"
                        (optionSelected)="onFunctionAutocompleteSelection($event)">
                        <mat-option *ngFor="let option of filteredFunctionOptions | async" [value]="option">
                            {{ option.label }}
                        </mat-option>
                    </mat-autocomplete>
                    <mat-hint>Find functions using the typeahead and select them to associate</mat-hint>
                </mat-form-field>
            </div>

        </div>



        <div class="enrich__container">

            <div class="enrich__section">
                <!-- TOPICS -->
                <mat-form-field floatLabel="always">
                    <mat-label>Topics</mat-label>
                    <mat-chip-list #topicChipList>
                        <mat-chip
                            *ngFor="let topic of topics"
                            [selectable]="true"
                            [removable]="true"
                            (removed)="removeTopic(topic)">
                            {{topic.label}}
                            <mat-icon matChipRemove>cancel</mat-icon>
                        </mat-chip>
                        <input matInput #topicInput
                            formControlName="topics"
                            [matAutocomplete]="topicAutoComplete"
                            [matChipInputFor]="topicChipList"
                            (matChipInputTokenEnd)="addTopic($event)"
                            placeholder="Specify topic(s) for this resource">
                        <mat-icon matSuffix
                            *ngIf="topicsField.nativeElement.value.length"
                            (click)="topicsField.nativeElement.value=''">
                            close
                        </mat-icon>
                    </mat-chip-list>
                    <mat-autocomplete #topicAutoComplete="matAutocomplete"
                        (optionSelected)="onTopicAutocompleteSelection($event)">
                        <mat-option *ngFor="let option of filteredTopicOptions | async" [value]="option">
                            {{ option.label }} <span class="u-text--xs t-fg--gray-md">{{ option.uri }}</span>
                        </mat-option>
                    </mat-autocomplete>
                    <mat-hint>Find topics using the typeahead and select them to associate</mat-hint>
                </mat-form-field>
            </div>

            <div class="enrich__section">
                <!-- SUBJECTS -->
                <mat-form-field floatLabel="always">
                    <mat-label>Subject</mat-label>
                    <mat-chip-list #subjectChipList>
                        <mat-chip
                            *ngFor="let subject of subjects"
                            [selectable]="true"
                            [removable]="true"
                            (removed)="removeSubject(subject)">
                            {{subject.label}}
                            <mat-icon matChipRemove>cancel</mat-icon>
                        </mat-chip>
                        <input matInput #subjectInput
                            formControlName="subjects"
                            [matAutocomplete]="subjectAutoComplete"
                            [matChipInputFor]="subjectChipList"
                            (matChipInputTokenEnd)="addSubject($event)"
                            placeholder="Specify subject(s) for this resource">
                        <mat-icon matSuffix
                            *ngIf="subjectsField.nativeElement.value.length"
                            (click)="subjectsField.nativeElement.value=''">
                            close
                        </mat-icon>
                    </mat-chip-list>
                    <mat-autocomplete #subjectAutoComplete="matAutocomplete"
                        (optionSelected)="onSubjectAutocompleteSelection($event)">
                        <mat-option *ngFor="let option of filteredSubjectOptions | async" [value]="option">
                            {{ option.label }}
                        </mat-option>
                    </mat-autocomplete>
                    <mat-hint>Find subjects using the typeahead and select them to associate</mat-hint>
                </mat-form-field>
            </div>

        </div>



        <div class="enrich__container">

            <div class="enrich__section">
                <!-- PLACES -->
                <mat-form-field floatLabel="always">
                    <mat-label>Place</mat-label>
                    <mat-chip-list #placeChipList>
                        <mat-chip
                            *ngFor="let place of places"
                            [selectable]="true"
                            [removable]="true"
                            (removed)="removePlace(place)">
                            {{place.label}}
                            <mat-icon matChipRemove>cancel</mat-icon>
                        </mat-chip>
                        <input matInput #placeInput
                            formControlName="places"
                            [matAutocomplete]="placeAutoComplete"
                            [matChipInputFor]="placeChipList"
                            (matChipInputTokenEnd)="addPlace($event)"
                            placeholder="Specify place(s) for this resource">
                        <mat-icon matSuffix
                            *ngIf="placesField.nativeElement.value.length"
                            (click)="placesField.nativeElement.value=''">close</mat-icon>
                    </mat-chip-list>
                    <mat-autocomplete #placeAutoComplete="matAutocomplete"
                        (optionSelected)="onPlaceAutocompleteSelection($event)">
                        <mat-option *ngFor="let option of filteredPlaceOptions | async" [value]="option">
                            {{ option.label }} <span class="u-text--xs t-fg--gray-md">{{ option.uri }}</span>
                        </mat-option>
                    </mat-autocomplete>
                    <mat-hint>Find places using the typeahead and select them to associate</mat-hint>
                </mat-form-field>
            </div>

            <div class="enrich__section">
                <!-- CATEGORIES -->
                <mat-form-field floatLabel="always">
                    <mat-label>Category</mat-label>
                    <mat-chip-list #categoryChipList>
                        <mat-chip
                            *ngFor="let category of categories"
                            [selectable]="true"
                            [removable]="true"
                            (removed)="removeCategory(category)">
                            {{category.label}}
                            <mat-icon matChipRemove>cancel</mat-icon>
                        </mat-chip>
                        <input matInput #categoryInput
                            formControlName="categories"
                            [matAutocomplete]="categoryAutoComplete"
                            [matChipInputFor]="categoryChipList"
                            (matChipInputTokenEnd)="addCategory($event)"
                            placeholder="Specify categories for this resource">
                        <mat-icon matSuffix
                            *ngIf="categoriesField.nativeElement.value.length"
                            (click)="categoriesField.nativeElement.value=''">close</mat-icon>
                    </mat-chip-list>
                    <mat-autocomplete #categoryAutoComplete="matAutocomplete"
                        (optionSelected)="onCategoryAutocompleteSelection($event)">
                        <mat-option *ngFor="let option of filteredCategoryOptions | async" [value]="option">
                            {{ option.label }}
                        </mat-option>
                    </mat-autocomplete>
                    <mat-hint>Find categories using the typeahead and select them to associate</mat-hint>
                </mat-form-field>
            </div>

        </div>



        <div class="enrich__container">

            <div class="enrich__section">
                <!-- AUDIENCE -->
                <mat-form-field floatLabel="always">
                    <mat-label>Audience</mat-label>
                    <mat-chip-list #audienceChipList>
                        <mat-chip
                            *ngFor="let aud of audience"
                            [selectable]="true"
                            [removable]="true"
                            (removed)="removeAudience(aud)">
                            {{aud.label}}
                            <mat-icon matChipRemove>cancel</mat-icon>
                        </mat-chip>
                        <input matInput #audienceInput
                            formControlName="audience"
                            [matAutocomplete]="audienceAutoComplete"
                            [matChipInputFor]="audienceChipList"
                            (matChipInputTokenEnd)="addAudience($event)"
                            placeholder="Specify audiences for this resource">
                        <mat-icon matSuffix
                            *ngIf="audienceField.nativeElement.value.length"
                            (click)="audienceField.nativeElement.value=''">close</mat-icon>
                    </mat-chip-list>
                    <mat-autocomplete #audienceAutoComplete="matAutocomplete"
                        (optionSelected)="onAudienceAutocompleteSelection($event)">
                        <mat-option *ngFor="let option of filteredAudienceOptions | async" [value]="option">
                            {{ option.label }}
                        </mat-option>
                    </mat-autocomplete>
                    <mat-hint>Find audiences using the typeahead and select them to associate</mat-hint>
                </mat-form-field>
            </div>

        </div>


    </form>


    <mat-card-actions>
        <div class="m-step__buttons">
            <button mat-raised-button matStepperPrevious>Back</button>
            <button mat-raised-button color="primary" matStepperNext
                [disabled]="formGroup.invalid || !data.createdBy">Continue</button>
        </div>
    </mat-card-actions>

</mat-card>
